<!-- Minimal Header with Button-like Elements -->
<div class="minimal-header" style="position:fixed; top:0; left:0; width:100vw; z-index:1050; padding:16px; background:transparent;">
  <div class="d-flex align-items-center justify-content-between" style="max-width: 100%;">
    <!-- Title Button with Dropdown -->
    <div class="dropdown">
      <a href="/" class="btn minimal-title-btn" id="episcopalLineageBtn">
        Episcopal Lineage
      </a>
      <div class="dropdown-menu" id="episcopalLineageDropdown" style="display: none; position: absolute; top: 100%; left: 0; z-index: 9999; min-width: 200px; padding: 8px 0; margin: 2px 0 0; background-color: #2c3e50; border: 1px solid #34495e; border-radius: 6px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);">
        <a class="dropdown-item" href="/" style="display: block; width: 100%; padding: 8px 16px; color: #ecf0f1; text-decoration: none; font-size: 0.9rem; transition: background-color 0.2s ease; cursor: pointer;" onmouseover="this.style.backgroundColor='#34495e'; this.style.color='#fff';" onmouseout="this.style.backgroundColor='transparent'; this.style.color='#ecf0f1';">
          <i class="fas fa-project-diagram me-2"></i>Lineage View
        </a>
        <a class="dropdown-item" href="/geographic" style="display: block; width: 100%; padding: 8px 16px; color: #ecf0f1; text-decoration: none; font-size: 0.9rem; transition: background-color 0.2s ease; cursor: pointer;" onmouseover="this.style.backgroundColor='#34495e'; this.style.color='#fff';" onmouseout="this.style.backgroundColor='transparent'; this.style.color='#ecf0f1';">
          <i class="fas fa-globe me-2"></i>Geographic View
        </a>
      </div>
    </div>
    
    <!-- Right Side Buttons -->
    <div class="d-flex align-items-center gap-2">
      <!-- Search Button (only on lineage visualization page) -->
      <button id="navbar-search-btn" class="btn minimal-action-btn" title="Search clergy" style="display: none;">
        <i class="fas fa-search"></i>
      </button>
      {% if session.get('is_admin') %}
        <a href="{{ url_for('editor.editor') }}#settings" class="btn minimal-action-btn" title="Settings">
          <i class="fas fa-cog"></i>
        </a>
      {% endif %}
      {% if session.get('user_id') %}
        <a href="#" class="btn minimal-action-btn" title="Logout" hx-get="{{ url_for('auth.logout') }}" hx-target="body" hx-push-url="true">
          <i class="fas fa-sign-out-alt"></i>
        </a>
      {% else %}
        <a href="{{ url_for('auth.login') }}" class="btn minimal-action-btn" title="Login">
          <i class="fas fa-sign-in-alt"></i>
        </a>
      {% endif %}
    </div>
  </div>
</div>

<!-- Spacer to prevent content from being hidden behind navbar -->
<!-- <div style="height:68px;"></div>  -->

<script>
// Handle Episcopal Lineage dropdown
document.addEventListener('DOMContentLoaded', function() {
    const episcopalLineageBtn = document.getElementById('episcopalLineageBtn');
    const episcopalLineageDropdown = document.getElementById('episcopalLineageDropdown');
    
    if (episcopalLineageBtn && episcopalLineageDropdown) {
        // Toggle dropdown on click
        episcopalLineageBtn.addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation();
            
            // Close other dropdowns
            document.querySelectorAll('.dropdown-menu').forEach(menu => {
                if (menu !== episcopalLineageDropdown) {
                    menu.style.display = 'none';
                    menu.classList.remove('show');
                }
            });
            
            // Toggle current dropdown
            const isVisible = episcopalLineageDropdown.style.display === 'block';
            
            if (isVisible) {
                episcopalLineageDropdown.style.display = 'none';
                episcopalLineageDropdown.classList.remove('show');
            } else {
                episcopalLineageDropdown.style.display = 'block';
                episcopalLineageDropdown.classList.add('show');
            }
        });
        
        // Close dropdown when clicking outside
        document.addEventListener('click', function(e) {
            if (!episcopalLineageBtn.contains(e.target) && !episcopalLineageDropdown.contains(e.target)) {
                episcopalLineageDropdown.style.display = 'none';
                episcopalLineageDropdown.classList.remove('show');
            }
        });
        
        // Close dropdown when clicking on dropdown items (but allow navigation)
        episcopalLineageDropdown.addEventListener('click', function(e) {
            if (e.target.tagName === 'A') {
                // Close dropdown but allow navigation
                setTimeout(() => {
                    episcopalLineageDropdown.style.display = 'none';
                    episcopalLineageDropdown.classList.remove('show');
                }, 100);
            }
        });
    }
});
</script>